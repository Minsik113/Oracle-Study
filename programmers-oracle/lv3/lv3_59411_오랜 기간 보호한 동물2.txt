-- 입양간 동물이 기준임
SELECT O.ANIMAL_ID
    ,O.NAME
FROM (SELECT O.ANIMAL_ID ANIMAL_ID
            ,O.NAME NAME
            ,O.DATETIME DATETIME
     FROM ANIMAL_OUTS O, ANIMAL_INS I
     WHERE O.ANIMAL_ID = I.ANIMAL_ID(+)
        AND I.ANIMAL_ID IS NOT NULL
     ORDER BY (O.DATETIME - I.DATETIME) DESC) O, ANIMAL_INS I
WHERE O.ANIMAL_ID = I.ANIMAL_ID
    AND I.ANIMAL_ID IS NOT NULL
    AND ROWNUM <=2
;